// Copyright (c) 2024-2025, The tinyavif contributors. All rights reserved
//
// This source code is subject to the terms of the BSD 2 Clause License and
// the Alliance for Open Media Patent License 1.0. If the BSD 2 Clause License
// was not distributed with this source code in the LICENSE file, you can
// obtain it at www.aomedia.org/license/software. If the Alliance for Open
// Media Patent License 1.0 was not distributed with this source code in the
// PATENTS file, you can obtain it at www.aomedia.org/license/patent.

// All of the CDFs used in the encoder currently

use crate::consts::*;

// Partitions
// For 8x8, the options are NONE, HORZ, VERT, SPLIT only;
// for larger sizes, T-shaped and 4-way partitions are also available
// (HORZ_A, HORZ_B, VERT_A, VERT_B, HORZ_4, VERT_4)

// We only ever use one context for 8x8 partitions, so don't
// bother including the other three
pub const partition_8x8_cdf: [u16; 3] = [19132, 25510, 30392];

pub const partition_16x16_cdf: [[u16; 9]; 4] = [
  [15597, 20929, 24571, 26706, 27664, 28821, 29601, 30571, 31902],
  [7925, 11043, 16785, 22470, 23971, 25043, 26651, 28701, 29834],
  [5414, 13269, 15111, 20488, 22360, 24500, 25537, 26336, 32117],
  [2662, 6362, 8614, 20860, 23053, 24778, 26436, 27829, 31171]
];

pub const partition_32x32_cdf: [[u16; 9]; 4] = [
  [18462, 20920, 23124, 27647, 28227, 29049, 29519, 30178, 31544],
  [7689, 9060, 12056, 24992, 25660, 26182, 26951, 28041, 29052],
  [6015, 9009, 10062, 24544, 25409, 26545, 27071, 27526, 32047],
  [1394, 2208, 2796, 28614, 29061, 29466, 29840, 30185, 31899]
];

pub const partition_64x64_cdf: [[u16; 9]; 4] = [
  [20137, 21547, 23078, 29566, 29837, 30261, 30524, 30892, 31724],
  [6732, 7490, 9497, 27944, 28250, 28515, 28969, 29630, 30104],
  [5945, 7663, 8348, 28683, 29117, 29749, 30064, 30298, 32238],
  [870, 1212, 1487, 31198, 31394, 31574, 31743, 31881, 32332]
];

// Block mode syntax
// This encoder arranges things so that these only ever use one context each,
// so just store the single relevant CDF
pub const skip_cdf: [u16; 1] = [31671];
pub const y_mode_cdf: [u16; 12] = [15588, 17027, 19338, 20218, 20682, 21110, 21825, 23244, 24189, 28165, 29093, 30466];
pub const uv_mode_cdf: [u16; 13] = [10407, 11208, 12900, 13181, 13823, 14175, 14899, 15656, 15986, 20086, 20995, 22455, 24212];

// Residual syntax
// These CDFs all have complex contexts, some of which are fixed in our case
// and some of which are not. They also all depend on the qindex via the qctx value.

pub const all_zero_cdf: [[[[u16; 1]; TXB_SKIP_CONTEXTS]; SUPPORTED_TX_SIZES]; TOKEN_CDF_Q_CTXS] = [
  // qctx = 0
  [ 
    // 4x4
    [ [31849],
      [5892],
      [12112],
      [21935],
      [20289],
      [27473],
      [32487],
      [7654],
      [19473],
      [29984],
      [9961],
      [30242],
      [32117] ],
    // 8x8
    [ [31548],
      [1549],
      [10130],
      [16656],
      [18591],
      [26308],
      [32537],
      [5403],
      [18096],
      [30003],
      [16384],
      [16384],
      [16384] ]
  ],
  // qctx = 1
  [
    // 4x4
    [ [30371],
      [7570],
      [13155],
      [20751],
      [20969],
      [27067],
      [32013],
      [5495],
      [17942],
      [28280],
      [16384],
      [16384],
      [16384] ],
    // 8x8
    [ [31782],
      [1836],
      [10689],
      [17604],
      [21622],
      [27518],
      [32399],
      [4419],
      [16294],
      [28345],
      [16384],
      [16384],
      [16384] ],
  ],
  // qctx = 2
  [
    // 4x4
    [ [29614],
      [9068],
      [12924],
      [19538],
      [17737],
      [24619],
      [30642],
      [4119],
      [16026],
      [25657],
      [16384],
      [16384],
      [16384] ],
    // 8x8
    [ [31957],
      [3230],
      [11153],
      [18123],
      [20143],
      [26536],
      [31986],
      [3050],
      [14603],
      [25155],
      [16384],
      [16384],
      [16384] ],
  ],
  // qctx = 3
  [
    // 4x4
    [ [26887],
      [6729],
      [10361],
      [17442],
      [15045],
      [22478],
      [29072],
      [2713],
      [11861],
      [20773],
      [16384],
      [16384],
      [16384] ],
    // 8x8
    [ [31903],
      [2044],
      [7528],
      [14618],
      [16182],
      [24168],
      [31037],
      [2786],
      [11194],
      [20155],
      [16384],
      [16384],
      [16384] ],
  ]
];

// The tx type encoding depends on a lot of factors:
// inter vs. intra, tx set, luma tx size and luma mode
// For our use case, these are always the same, so we only need one CDF
pub const tx_type_cdf: [u16; 4] = [6554, 13107, 19661, 26214];

// For EOB, there are separate CDFs per transform size to account for the
// different number of coefficients available.
// Each CDF also depends on the plane type (luma/chroma) and the transform class
// (which in our case is always 0)
pub const eob_class_16_cdf: [[[u16; 4]; PLANE_TYPES]; TOKEN_CDF_Q_CTXS] = [
  // qctx = 0
  [
    [ 840, 1039, 1980, 4895 ], // Luma
    [ 3247, 4950, 9688, 14563 ] // Chroma
  ],
  // qctx = 1
  [
    [ 2125, 2551, 5165, 8946 ],
    [ 7637, 9498, 14259, 19108 ]
  ],
  // qctx = 2
  [
    [ 4016, 4897, 8881, 14968 ],
    [ 11139, 13270, 18241, 23566 ]
  ],
  // qctx = 3
  [
    [ 6708, 8958, 14746, 22133 ],
    [ 19575, 21766, 26044, 29709 ]
  ]
];

pub const eob_class_64_cdf: [[[u16; 6]; PLANE_TYPES]; TOKEN_CDF_Q_CTXS] = [
  // qctx = 0
  [
    [ 329, 498, 1101, 1784, 3265, 7758 ], // Y
    [ 3505, 5304, 10086, 13814, 17684, 23370 ] // U/V
  ],
  // qctx = 1
  [
    [ 1260, 1446, 2253, 3712, 6652, 13369 ],
    [ 8609, 10612, 14624, 18714, 22614, 29024 ]
  ],
  // qctx = 2
  [
    [ 2374, 2772, 4583, 7276, 12288, 19706 ],
    [ 15050, 17126, 21410, 24886, 28156, 30726 ]
  ],
  // qctx = 3
  [
    [ 6307, 7541, 12060, 16358, 22553, 27865 ],
    [ 24212, 25708, 28268, 30035, 31307, 32049 ]
  ]
];

pub const eob_extra_4x4_cdf: [[[[u16; 1]; 3]; PLANE_TYPES]; TOKEN_CDF_Q_CTXS] = [
  // qctx = 0
  [
    // Y
    [
      [ 16961 ],
      [ 17223 ],
      [ 7621 ],
    ],
    // U/V
    [
      [ 19069 ],
      [ 22525 ],
      [ 13377 ],
    ]
  ],
  // qctx = 1
  [
    // Y
    [
      [ 17471 ],
      [ 20223 ],
      [ 11357 ],
    ],
    // U/V
    [
      [ 20335 ],
      [ 21667 ],
      [ 14818 ],
    ]
  ],
  // qctx = 2
  [
    // Y
    [
      [ 18983 ],
      [ 20512 ],
      [ 14885 ],
    ],
    // U/V
    [
      [ 20090 ],
      [ 19444 ],
      [ 17286 ],
    ]
  ],
  // qctx = 3
  [
    // Y
    [
      [ 20177 ],
      [ 20789 ],
      [ 20262 ],
    ],
    // U/V
    [
      [ 21416 ],
      [ 20855 ],
      [ 23410 ],
    ]
  ],
];

pub const eob_extra_8x8_cdf: [[[[u16; 1]; 5]; PLANE_TYPES]; TOKEN_CDF_Q_CTXS] = [
  // qctx = 0
  [
    // Y
    [
      [ 20401 ],
      [ 17025 ],
      [ 12845 ],
      [ 12873 ],
      [ 14094 ],
    ],
    // U/V
    [
      [ 20681 ],
      [ 20701 ],
      [ 15250 ],
      [ 15017 ],
      [ 14928 ],
    ]
  ],
  // qctx = 1
  [
    // Y
    [
      [ 20430 ],
      [ 20662 ],
      [ 15367 ],
      [ 16970 ],
      [ 14657 ],
    ],
    // U/V
    [
      [ 22117 ],
      [ 22028 ],
      [ 18650 ],
      [ 16042 ],
      [ 15885 ],
    ]
  ],
  // qctx = 2
  [
    // Y
    [
      [ 19139 ],
      [ 21487 ],
      [ 18959 ],
      [ 20910 ],
      [ 19089 ],
    ],
    // U/V
    [
      [ 20536 ],
      [ 20664 ],
      [ 20625 ],
      [ 19123 ],
      [ 14862 ],
    ]
  ],
  // qctx = 3
  [
    // Y
    [
      [ 20238 ],
      [ 21057 ],
      [ 19159 ],
      [ 22337 ],
      [ 20159 ],
    ],
    // U/V
    [
      [ 20125 ],
      [ 20559 ],
      [ 21707 ],
      [ 22296 ],
      [ 17333 ],
    ]
  ],
];

pub const coeff_base_eob_cdf: [[[[[u16; 2]; COEFF_BASE_EOB_CONTEXTS]; PLANE_TYPES]; SUPPORTED_TX_SIZES]; TOKEN_CDF_Q_CTXS] = [
  // qctx = 0
  [
    // 4x4
    [
      // Y
      [
        [ 17837, 29055 ],
        [ 29600, 31446 ],
        [ 30844, 31878 ],
        [ 24926, 28948 ]
      ],
      // U/V
      [
        [ 21365, 30026 ],
        [ 30512, 32423 ],
        [ 31658, 32621 ],
        [ 29630, 31881 ]
      ]
    ],
    // 8x8
    [
      // Y
      [
        [ 5717, 26477 ],
        [ 30491, 31703 ],
        [ 31550, 32158 ],
        [ 29648, 31491 ]
      ],
      // U/V
      [
        [ 12608, 27820 ],
        [ 30680, 32225 ],
        [ 30809, 32335 ],
        [ 31299, 32423 ]
      ]
    ]
  ],
  // qctx = 1
  [
    // 4x4
    [
      // Y
      [
        [ 17560, 29888 ],
        [ 29671, 31549 ],
        [ 31007, 32056 ],
        [ 27286, 30006 ]
      ],
      // U/V
      [
        [ 26594, 31212 ],
        [ 31208, 32582 ],
        [ 31835, 32637 ],
        [ 30595, 32206 ]
      ]
    ],
    // 8x8
    [
      // Y
      [
        [ 15239, 29932 ],
        [ 31315, 32095 ],
        [ 32130, 32434 ],
        [ 30864, 31996 ]
      ],
      // U/V
      [
        [ 26279, 30968 ],
        [ 31142, 32495 ],
        [ 31713, 32540 ],
        [ 31929, 32594 ]
      ]
    ]
  ],
  // qctx = 2
  [
    // 4x4
    [
      // Y
      [
        [ 20092, 30774 ],
        [ 30695, 32020 ],
        [ 31131, 32103 ],
        [ 28666, 30870 ]
      ],
      // U/V
      [
        [ 27258, 31095 ],
        [ 31804, 32623 ],
        [ 31763, 32528 ],
        [ 31438, 32506 ]
      ]
    ],
    // 8x8
    [
      // Y
      [
        [ 18049, 30489 ],
        [ 31706, 32286 ],
        [ 32163, 32473 ],
        [ 31550, 32184 ]
      ],
      // U/V
      [
        [ 27116, 30842 ],
        [ 31971, 32598 ],
        [ 32088, 32576 ],
        [ 32067, 32664 ]
      ]
    ]
  ],
  // qctx = 3
  [
    // 4x4
    [
      // Y
      [
        [ 22497, 31198 ],
        [ 31715, 32495 ],
        [ 31606, 32337 ],
        [ 30388, 31990 ]
      ],
      // U/V
      [
        [ 27877, 31584 ],
        [ 32170, 32728 ],
        [ 32155, 32688 ],
        [ 32219, 32702 ]
      ]
    ],
    // 8x8
    [
      // Y
      [
        [ 21457, 31043 ],
        [ 31951, 32483 ],
        [ 32153, 32562 ],
        [ 31473, 32215 ]
      ],
      // U/V
      [
        [ 27558, 31151 ],
        [ 32020, 32640 ],
        [ 32097, 32575 ],
        [ 32242, 32719 ]
      ]
    ]
  ]
];

pub const coeff_base_cdf: [[[[[u16; 3]; COEFF_BASE_CONTEXTS]; PLANE_TYPES]; SUPPORTED_TX_SIZES]; TOKEN_CDF_Q_CTXS] = [
  // qctx = 0
  [
    // 4x4
    [
      // Y
      [
        [4034, 8930, 12727],
        [18082, 29741, 31877],
        [12596, 26124, 30493],
        [9446, 21118, 27005],
        [6308, 15141, 21279],
        [2463, 6357, 9783],
        [20667, 30546, 31929],
        [13043, 26123, 30134],
        [8151, 18757, 24778],
        [5255, 12839, 18632],
        [2820, 7206, 11161],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [15736, 27553, 30604],
        [11210, 23794, 28787],
        [5947, 13874, 19701],
        [4215, 9323, 13891],
        [2833, 6462, 10059],
      ],
      // U/V
      [
        [6302, 16444, 21761],
        [23040, 31538, 32475],
        [15196, 28452, 31496],
        [10020, 22946, 28514],
        [6533, 16862, 23501],
        [3538, 9816, 15076],
        [24444, 31875, 32525],
        [15881, 28924, 31635],
        [9922, 22873, 28466],
        [6527, 16966, 23691],
        [4114, 11303, 17220],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [20201, 30770, 32209],
        [14754, 28071, 31258],
        [8378, 20186, 26517],
        [5916, 15299, 21978],
        [4268, 11583, 17901],
      ],
    ],
    // 8x8
    [
      // Y
      [
        [4536, 10072, 14001],
        [25459, 31416, 32206],
        [16605, 28048, 30818],
        [11008, 22857, 27719],
        [6915, 16268, 22315],
        [2625, 6812, 10537],
        [24257, 31788, 32499],
        [16880, 29454, 31879],
        [11958, 25054, 29778],
        [7916, 18718, 25084],
        [3383, 8777, 13446],
        [22720, 31603, 32393],
        [14960, 28125, 31335],
        [9731, 22210, 27928],
        [6304, 15832, 22277],
        [2910, 7818, 12166],
        [20375, 30627, 32131],
        [13904, 27284, 30887],
        [9368, 21558, 27144],
        [5937, 14966, 21119],
        [2667, 7225, 11319],
        [23970, 31470, 32378],
        [17173, 29734, 32018],
        [12795, 25441, 29965],
        [8981, 19680, 25893],
        [4728, 11372, 16902],
      ],
      // U/V
      [
        [6037, 16771, 21957],
        [24774, 31704, 32426],
        [16830, 28589, 31056],
        [10602, 22828, 27760],
        [6733, 16829, 23071],
        [3250, 8914, 13556],
        [25582, 32220, 32668],
        [18659, 30342, 32223],
        [12546, 26149, 30515],
        [8420, 20451, 26801],
        [4636, 12420, 18344],
        [27581, 32362, 32639],
        [18987, 30083, 31978],
        [11327, 24248, 29084],
        [7264, 17719, 24120],
        [3995, 10768, 16169],
        [25893, 31831, 32487],
        [16577, 28587, 31379],
        [10189, 22748, 28182],
        [6832, 17094, 23556],
        [3708, 10110, 15334],
        [25904, 32282, 32656],
        [19721, 30792, 32276],
        [12819, 26243, 30411],
        [8572, 20614, 26891],
        [5364, 14059, 20467],
      ],
    ],
  ],
  // qctx = 1
  [
    // 4x4
    [
      // Y
      [
        [6041, 11854, 15927],
        [20326, 30905, 32251],
        [14164, 26831, 30725],
        [9760, 20647, 26585],
        [6416, 14953, 21219],
        [2966, 7151, 10891],
        [23567, 31374, 32254],
        [14978, 27416, 30946],
        [9434, 20225, 26254],
        [6658, 14558, 20535],
        [3916, 8677, 12989],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [18088, 29545, 31587],
        [13062, 25843, 30073],
        [8940, 16827, 22251],
        [7654, 13220, 17973],
        [5733, 10316, 14456],
      ],
      // U/V
      [
        [8455, 19003, 24368],
        [23563, 32021, 32604],
        [16237, 29446, 31935],
        [10724, 23999, 29358],
        [6725, 17528, 24416],
        [3927, 10927, 16825],
        [26313, 32288, 32634],
        [17430, 30095, 32095],
        [11116, 24606, 29679],
        [7195, 18384, 25269],
        [4726, 12852, 19315],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [22822, 31648, 32483],
        [16724, 29633, 31929],
        [10261, 23033, 28725],
        [7029, 17840, 24528],
        [4867, 13886, 21502],
      ],
    ],
    // 8x8
    [
      // Y
      [
        [6779, 13743, 17678],
        [24806, 31797, 32457],
        [17616, 29047, 31372],
        [11063, 23175, 28003],
        [6521, 16110, 22324],
        [2764, 7504, 11654],
        [25266, 32367, 32637],
        [19054, 30553, 32175],
        [12139, 25212, 29807],
        [7311, 18162, 24704],
        [3397, 9164, 14074],
        [25988, 32208, 32522],
        [16253, 28912, 31526],
        [9151, 21387, 27372],
        [5688, 14915, 21496],
        [2717, 7627, 12004],
        [23144, 31855, 32443],
        [16070, 28491, 31325],
        [8702, 20467, 26517],
        [5243, 13956, 20367],
        [2621, 7335, 11567],
        [26636, 32340, 32630],
        [19990, 31050, 32341],
        [13243, 26105, 30315],
        [8588, 19521, 25918],
        [4717, 11585, 17304],
      ],
      // U/V
      [
        [8639, 19339, 24429],
        [24404, 31837, 32525],
        [16997, 29425, 31784],
        [11253, 24234, 29149],
        [6751, 17394, 24028],
        [3490, 9830, 15191],
        [26283, 32471, 32714],
        [19599, 31168, 32442],
        [13146, 26954, 30893],
        [8214, 20588, 26890],
        [4699, 13081, 19300],
        [28212, 32458, 32669],
        [18594, 30316, 32100],
        [11219, 24408, 29234],
        [6865, 17656, 24149],
        [3678, 10362, 16006],
        [25825, 32136, 32616],
        [17313, 29853, 32021],
        [11197, 24471, 29472],
        [6947, 17781, 24405],
        [3768, 10660, 16261],
        [27352, 32500, 32706],
        [20850, 31468, 32469],
        [14021, 27707, 31133],
        [8964, 21748, 27838],
        [5437, 14665, 21187],
      ],
    ],
  ],
  // qctx = 2
  [
    // 4x4
    [
      // Y
      [
        [8896, 16227, 20630],
        [23629, 31782, 32527],
        [15173, 27755, 31321],
        [10158, 21233, 27382],
        [6420, 14857, 21558],
        [3269, 8155, 12646],
        [24835, 32009, 32496],
        [16509, 28421, 31579],
        [10957, 21514, 27418],
        [7881, 15930, 22096],
        [5388, 10960, 15918],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [20745, 30773, 32093],
        [15200, 27221, 30861],
        [13032, 20873, 25667],
        [12285, 18663, 23494],
        [11563, 17481, 21489],
      ],
      // U/V
      [
        [10808, 22056, 26896],
        [25739, 32313, 32676],
        [17288, 30203, 32221],
        [11359, 24878, 29896],
        [6949, 17767, 24893],
        [4287, 11796, 18071],
        [27880, 32521, 32705],
        [19038, 31004, 32414],
        [12564, 26345, 30768],
        [8269, 19947, 26779],
        [5674, 14657, 21674],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [25742, 32319, 32671],
        [19557, 31164, 32454],
        [13381, 26381, 30755],
        [10101, 21466, 26722],
        [9209, 19650, 26825],
      ],
    ],
    // 8x8
    [
      // Y
      [
        [9704, 17294, 21132],
        [26762, 32278, 32633],
        [18382, 29620, 31819],
        [10891, 23475, 28723],
        [6358, 16583, 23309],
        [3248, 9118, 14141],
        [27204, 32573, 32699],
        [19818, 30824, 32329],
        [11772, 25120, 30041],
        [6995, 18033, 25039],
        [3752, 10442, 16098],
        [27222, 32256, 32559],
        [15356, 28399, 31475],
        [8821, 20635, 27057],
        [5511, 14404, 21239],
        [2935, 8222, 13051],
        [24875, 32120, 32529],
        [15233, 28265, 31445],
        [8605, 20570, 26932],
        [5431, 14413, 21196],
        [2994, 8341, 13223],
        [28201, 32604, 32700],
        [21041, 31446, 32456],
        [13221, 26213, 30475],
        [8255, 19385, 26037],
        [4930, 12585, 18830],
      ],
      // U/V
      [
        [11016, 22111, 26794],
        [25946, 32357, 32677],
        [17890, 30452, 32252],
        [11678, 25142, 29816],
        [6720, 17534, 24584],
        [4230, 11665, 17820],
        [28400, 32623, 32747],
        [21164, 31668, 32575],
        [13572, 27388, 31182],
        [8234, 20750, 27358],
        [5065, 14055, 20897],
        [28981, 32547, 32705],
        [18681, 30543, 32239],
        [10919, 24075, 29286],
        [6431, 17199, 24077],
        [3819, 10464, 16618],
        [26870, 32467, 32693],
        [19041, 30831, 32347],
        [11794, 25211, 30016],
        [6888, 18019, 24970],
        [4370, 12363, 18992],
        [29578, 32670, 32744],
        [23159, 32007, 32613],
        [15315, 28669, 31676],
        [9298, 22607, 28782],
        [6144, 15913, 22968],
      ],
    ],
  ],
  // qctx = 3
  [
    // 4x4
    [
      // Y
      [
        [7062, 16472, 22319],
        [24538, 32261, 32674],
        [13675, 28041, 31779],
        [8590, 20674, 27631],
        [5685, 14675, 22013],
        [3655, 9898, 15731],
        [26493, 32418, 32658],
        [16376, 29342, 32090],
        [10594, 22649, 28970],
        [8176, 17170, 24303],
        [5605, 12694, 19139],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [23888, 31902, 32542],
        [18612, 29687, 31987],
        [16245, 24852, 29249],
        [15765, 22608, 27559],
        [19895, 24699, 27510],
      ],
      // U/V
      [
        [9320, 22102, 27840],
        [27057, 32464, 32724],
        [16331, 30268, 32309],
        [10319, 23935, 29720],
        [6189, 16448, 24106],
        [3589, 10884, 18808],
        [29026, 32624, 32748],
        [19226, 31507, 32587],
        [12692, 26921, 31203],
        [7049, 19532, 27635],
        [7727, 15669, 23252],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [8192, 16384, 24576],
        [28056, 32625, 32748],
        [22383, 32075, 32669],
        [15417, 27098, 31749],
        [18127, 26493, 27190],
        [5461, 16384, 21845],
      ],
    ],
    // 8x8
    [
      // Y
      [
        [7754, 16948, 22142],
        [25670, 32330, 32691],
        [15663, 29225, 31994],
        [9878, 23288, 29158],
        [6419, 17088, 24336],
        [3859, 11003, 17039],
        [27562, 32595, 32725],
        [17575, 30588, 32399],
        [10819, 24838, 30309],
        [7124, 18686, 25916],
        [4479, 12688, 19340],
        [28385, 32476, 32673],
        [15306, 29005, 31938],
        [8937, 21615, 28322],
        [5982, 15603, 22786],
        [3620, 10267, 16136],
        [27280, 32464, 32667],
        [15607, 29160, 32004],
        [9091, 22135, 28740],
        [6232, 16632, 24020],
        [4047, 11377, 17672],
        [29220, 32630, 32718],
        [19650, 31220, 32462],
        [13050, 26312, 30827],
        [9228, 20870, 27468],
        [6146, 15149, 21971],
      ],
      // U/V
      [
        [8626, 20271, 26216],
        [26707, 32406, 32711],
        [16999, 30329, 32286],
        [11445, 25123, 30286],
        [6411, 18828, 25601],
        [6801, 12458, 20248],
        [29918, 32682, 32748],
        [20649, 31739, 32618],
        [12879, 27773, 31581],
        [7896, 21751, 28244],
        [5260, 14870, 23698],
        [29252, 32593, 32731],
        [17072, 30460, 32294],
        [10653, 24143, 29365],
        [6536, 17490, 23983],
        [4929, 13170, 20085],
        [28137, 32518, 32715],
        [18171, 30784, 32407],
        [11437, 25436, 30459],
        [7252, 18534, 26176],
        [4126, 13353, 20978],
        [31162, 32726, 32748],
        [23017, 32222, 32701],
        [15629, 29233, 32046],
        [9387, 22621, 29480],
        [6922, 17616, 25010],
      ],
    ],
  ],
];

pub const coeff_br_cdf: [[[[[u16; 3]; COEFF_BR_CONTEXTS]; PLANE_TYPES]; SUPPORTED_TX_SIZES]; TOKEN_CDF_Q_CTXS] = [
  // qctx = 0
  [
    // 4x4
    [
      // Y
      [
        [14298, 20718, 24174],
        [12536, 19601, 23789],
        [8712, 15051, 19503],
        [6170, 11327, 15434],
        [4742, 8926, 12538],
        [3803, 7317, 10546],
        [1696, 3317, 4871],
        [14392, 19951, 22756],
        [15978, 23218, 26818],
        [12187, 19474, 23889],
        [9176, 15640, 20259],
        [7068, 12655, 17028],
        [5656, 10442, 14472],
        [2580, 4992, 7244],
        [12136, 18049, 21426],
        [13784, 20721, 24481],
        [10836, 17621, 21900],
        [8372, 14444, 18847],
        [6523, 11779, 16000],
        [5337, 9898, 13760],
        [3034, 5860, 8462],
      ],
      // U/V
      [
        [15967, 22905, 26286],
        [13534, 20654, 24579],
        [9504, 16092, 20535],
        [6975, 12568, 16903],
        [5364, 10091, 14020],
        [4357, 8370, 11857],
        [2506, 4934, 7218],
        [23032, 28815, 30936],
        [19540, 26704, 29719],
        [15158, 22969, 27097],
        [11408, 18865, 23650],
        [8885, 15448, 20250],
        [7108, 12853, 17416],
        [4231, 8041, 11480],
        [19823, 26490, 29156],
        [18890, 25929, 28932],
        [15660, 23491, 27433],
        [12147, 19776, 24488],
        [9728, 16774, 21649],
        [7919, 14277, 19066],
        [5440, 10170, 14185],
      ],
    ],
    // 8x8
    [
      // Y
      [
        [14406, 20862, 24414],
        [11824, 18907, 23109],
        [8257, 14393, 18803],
        [5860, 10747, 14778],
        [4475, 8486, 11984],
        [3606, 6954, 10043],
        [1736, 3410, 5048],
        [14430, 20046, 22882],
        [15593, 22899, 26709],
        [12102, 19368, 23811],
        [9059, 15584, 20262],
        [6999, 12603, 17048],
        [5684, 10497, 14553],
        [2822, 5438, 7862],
        [15785, 21585, 24359],
        [18347, 25229, 28266],
        [14974, 22487, 26389],
        [11423, 18681, 23271],
        [8863, 15350, 20008],
        [7153, 12852, 17278],
        [3707, 7036, 9982],
      ],
      // U/V
      [
        [15460, 21696, 25469],
        [12170, 19249, 23191],
        [8723, 15027, 19332],
        [6428, 11704, 15874],
        [4922, 9292, 13052],
        [4139, 7695, 11010],
        [2291, 4508, 6598],
        [19856, 26920, 29828],
        [17923, 25289, 28792],
        [14278, 21968, 26297],
        [10910, 18136, 22950],
        [8423, 14815, 19627],
        [6771, 12283, 16774],
        [4074, 7750, 11081],
        [19852, 26074, 28672],
        [19371, 26110, 28989],
        [16265, 23873, 27663],
        [12758, 20378, 24952],
        [10095, 17098, 21961],
        [8250, 14628, 19451],
        [5205, 9745, 13622],
      ],
    ],
  ],
  // qctx = 1
  [
    // 4x4
    [
      // Y
      [
        [14995, 21341, 24749],
        [13158, 20289, 24601],
        [8941, 15326, 19876],
        [6297, 11541, 15807],
        [4817, 9029, 12776],
        [3731, 7273, 10627],
        [1847, 3617, 5354],
        [14472, 19659, 22343],
        [16806, 24162, 27533],
        [12900, 20404, 24713],
        [9411, 16112, 20797],
        [7056, 12697, 17148],
        [5544, 10339, 14460],
        [2954, 5704, 8319],
        [12464, 18071, 21354],
        [15482, 22528, 26034],
        [12070, 19269, 23624],
        [8953, 15406, 20106],
        [7027, 12730, 17220],
        [5887, 10913, 15140],
        [3793, 7278, 10447],
      ],
      // U/V
      [
        [15571, 22232, 25749],
        [14506, 21575, 25374],
        [10189, 17089, 21569],
        [7316, 13301, 17915],
        [5783, 10912, 15190],
        [4760, 9155, 13088],
        [2993, 5966, 8774],
        [23424, 28903, 30778],
        [20775, 27666, 30290],
        [16474, 24410, 28299],
        [12471, 20180, 24987],
        [9410, 16487, 21439],
        [7536, 13614, 18529],
        [5048, 9586, 13549],
        [21090, 27290, 29756],
        [20796, 27402, 30026],
        [17819, 25485, 28969],
        [13860, 21909, 26462],
        [11002, 18494, 23529],
        [8953, 15929, 20897],
        [6448, 11918, 16454],
      ],
    ],
    // 8x8
    [
      // Y
      [
        [15999, 22208, 25449],
        [13050, 19988, 24122],
        [8594, 14864, 19378],
        [6033, 11079, 15238],
        [4554, 8683, 12347],
        [3672, 7139, 10337],
        [1900, 3771, 5576],
        [15788, 21340, 23949],
        [16825, 24235, 27758],
        [12873, 20402, 24810],
        [9590, 16363, 21094],
        [7352, 13209, 17733],
        [5960, 10989, 15184],
        [3232, 6234, 9007],
        [15761, 20716, 23224],
        [19318, 25989, 28759],
        [15529, 23094, 26929],
        [11662, 18989, 23641],
        [8955, 15568, 20366],
        [7281, 13106, 17708],
        [4248, 8059, 11440],
      ],
      // U/V
      [
        [14899, 21217, 24503],
        [13519, 20283, 24047],
        [9429, 15966, 20365],
        [6700, 12355, 16652],
        [5088, 9704, 13716],
        [4243, 8154, 11731],
        [2702, 5364, 7861],
        [22745, 28388, 30454],
        [20235, 27146, 29922],
        [15896, 23715, 27637],
        [11840, 19350, 24131],
        [9122, 15932, 20880],
        [7488, 13581, 18362],
        [5114, 9568, 13370],
        [20845, 26553, 28932],
        [20981, 27372, 29884],
        [17781, 25335, 28785],
        [13760, 21708, 26297],
        [10975, 18415, 23365],
        [9045, 15789, 20686],
        [6130, 11199, 15423],
      ],
    ],
  ],
  // qctx = 2
  [
    // 4x4
    [
      // Y
      [
        [16138, 22223, 25509],
        [15347, 22430, 26332],
        [9614, 16736, 21332],
        [6600, 12275, 16907],
        [4811, 9424, 13547],
        [3748, 7809, 11420],
        [2254, 4587, 6890],
        [15196, 20284, 23177],
        [18317, 25469, 28451],
        [13918, 21651, 25842],
        [10052, 17150, 21995],
        [7499, 13630, 18587],
        [6158, 11417, 16003],
        [4014, 7785, 11252],
        [15048, 21067, 24384],
        [18202, 25346, 28553],
        [14302, 22019, 26356],
        [10839, 18139, 23166],
        [8715, 15744, 20806],
        [7536, 13576, 18544],
        [5413, 10335, 14498],
      ],
      // U/V
      [
        [17394, 24501, 27895],
        [15889, 23420, 27185],
        [11561, 19133, 23870],
        [8285, 14812, 19844],
        [6496, 12043, 16550],
        [4771, 9574, 13677],
        [3603, 6830, 10144],
        [21656, 27704, 30200],
        [21324, 27915, 30511],
        [17327, 25336, 28997],
        [13417, 21381, 26033],
        [10132, 17425, 22338],
        [8580, 15016, 19633],
        [5694, 11477, 16411],
        [24116, 29780, 31450],
        [23853, 29695, 31591],
        [20085, 27614, 30428],
        [15326, 24335, 28575],
        [11814, 19472, 24810],
        [10221, 18611, 24767],
        [7689, 14558, 20321],
      ],
    ],
    // 8x8
    [
      // Y
      [
        [16214, 22380, 25770],
        [14213, 21304, 25295],
        [9213, 15823, 20455],
        [6395, 11758, 16139],
        [4779, 9187, 13066],
        [3821, 7501, 10953],
        [2293, 4567, 6795],
        [15859, 21283, 23820],
        [18404, 25602, 28726],
        [14325, 21980, 26206],
        [10669, 17937, 22720],
        [8297, 14642, 19447],
        [6746, 12389, 16893],
        [4324, 8251, 11770],
        [16532, 21631, 24475],
        [20667, 27150, 29668],
        [16728, 24510, 28175],
        [12861, 20645, 25332],
        [10076, 17361, 22417],
        [8395, 14940, 19963],
        [5731, 10683, 14912],
      ],
      // U/V
      [
        [14433, 21155, 24938],
        [14658, 21716, 25545],
        [9923, 16824, 21557],
        [6982, 13052, 17721],
        [5419, 10503, 15050],
        [4852, 9162, 13014],
        [3271, 6395, 9630],
        [22210, 27833, 30109],
        [20750, 27368, 29821],
        [16894, 24828, 28573],
        [13247, 21276, 25757],
        [10038, 17265, 22563],
        [8587, 14947, 20327],
        [5645, 11371, 15252],
        [22027, 27526, 29714],
        [23098, 29146, 31221],
        [19886, 27341, 30272],
        [15609, 23747, 28046],
        [11993, 20065, 24939],
        [9637, 18267, 23671],
        [7625, 13801, 19144],
      ],
    ],
  ],
  // qctx = 3
  [
    // 4x4
    [
      // Y
      [
        [18315, 24289, 27551],
        [16854, 24068, 27835],
        [10140, 17927, 23173],
        [6722, 12982, 18267],
        [4661, 9826, 14706],
        [3832, 8165, 12294],
        [2795, 6098, 9245],
        [17145, 23326, 26672],
        [20733, 27680, 30308],
        [16032, 24461, 28546],
        [11653, 20093, 25081],
        [9290, 16429, 22086],
        [7796, 14598, 19982],
        [6502, 12378, 17441],
        [21681, 27732, 30320],
        [22389, 29044, 31261],
        [19027, 26731, 30087],
        [14739, 23755, 28624],
        [11358, 20778, 25511],
        [10995, 18073, 24190],
        [9162, 14990, 20617],
      ],
      // U/V
      [
        [21425, 27952, 30388],
        [18062, 25838, 29034],
        [11956, 19881, 24808],
        [7718, 15000, 20980],
        [5702, 11254, 16143],
        [4898, 9088, 16864],
        [3679, 6776, 11907],
        [23294, 30160, 31663],
        [24397, 29896, 31836],
        [19245, 27128, 30593],
        [13202, 19825, 26404],
        [11578, 19297, 23957],
        [8073, 13297, 21370],
        [5461, 10923, 19745],
        [27367, 30521, 31934],
        [24904, 30671, 31940],
        [23075, 28460, 31299],
        [14400, 23658, 30417],
        [13885, 23882, 28325],
        [14746, 22938, 27853],
        [5461, 16384, 27307],
      ],
    ],
    // 8x8
    [
      // Y
      [
        [18274, 24813, 27890],
        [15537, 23149, 27003],
        [9449, 16740, 21827],
        [6700, 12498, 17261],
        [4988, 9866, 14198],
        [4236, 8147, 11902],
        [2867, 5860, 8654],
        [17124, 23171, 26101],
        [20396, 27477, 30148],
        [16573, 24629, 28492],
        [12749, 20846, 25674],
        [10233, 17878, 22818],
        [8525, 15332, 20363],
        [6283, 11632, 16255],
        [20466, 26511, 29286],
        [23059, 29174, 31191],
        [19481, 27263, 30241],
        [15458, 23631, 28137],
        [12416, 20608, 25693],
        [10261, 18011, 23261],
        [8016, 14655, 19666],
      ],
      // U/V
      [
        [17616, 24586, 28112],
        [15809, 23299, 27155],
        [10767, 18890, 23793],
        [7727, 14255, 18865],
        [6129, 11926, 16882],
        [4482, 9704, 14861],
        [3277, 7452, 11522],
        [22956, 28551, 30730],
        [22724, 28937, 30961],
        [18467, 26324, 29580],
        [13234, 20713, 25649],
        [11181, 17592, 22481],
        [8291, 18358, 24576],
        [7568, 11881, 14984],
        [24948, 29001, 31147],
        [25674, 30619, 32151],
        [20841, 26793, 29603],
        [14669, 24356, 28666],
        [11334, 23593, 28219],
        [8922, 14762, 22873],
        [8301, 13544, 20535],
      ],
    ],
  ],
];

pub const dc_sign_cdf: [[[[u16; 1]; DC_SIGN_CONTEXTS]; PLANE_TYPES]; TOKEN_CDF_Q_CTXS] = [
  // qctx = 0
  [
    // Y
    [
      [ 128 * 125 ],
      [ 128 * 102 ],
      [ 128 * 147 ],
    ],
    // U/V
    [
      [ 128 * 119 ],
      [ 128 * 101 ],
      [ 128 * 135 ],
    ]
  ],
  // qctx = 1
  [
    // Y
    [
      [ 128 * 125 ],
      [ 128 * 102 ],
      [ 128 * 147 ],
    ],
    // U/V
    [
      [ 128 * 119 ],
      [ 128 * 101 ],
      [ 128 * 135 ],
    ]
  ],
  // qctx = 2
  [
    // Y
    [
      [ 128 * 125 ],
      [ 128 * 102 ],
      [ 128 * 147 ],
    ],
    // U/V
    [
      [ 128 * 119 ],
      [ 128 * 101 ],
      [ 128 * 135 ],
    ]
  ],
  // qctx = 3
  [
    // Y
    [
      [ 128 * 125 ],
      [ 128 * 102 ],
      [ 128 * 147 ],
    ],
    // U/V
    [
      [ 128 * 119 ],
      [ 128 * 101 ],
      [ 128 * 135 ],
    ]
  ],
];
